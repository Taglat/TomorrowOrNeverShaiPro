# SHAI - –°–∏—Å—Ç–µ–º–∞ –ü—Å–∏—Ö–æ-–≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–π –ü–æ–¥–¥–µ—Ä–∂–∫–∏ –°—Ç—É–¥–µ–Ω—Ç–æ–≤ üéì

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç—É–∞–ª—å–Ω–æ–≥–æ —á–∞—Ç-–±–æ—Ç–∞, —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–≥–æ –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –ø—Å–∏—Ö–æ-—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å—Ç—É–¥–µ–Ω—Ç–æ–≤. –ë–æ—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram –∫–∞–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å SHAI.pro –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

- ü§ù –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—â–∏–π –¥–∏–∞–ª–æ–≥ —Å–æ —Å—Ç—É–¥–µ–Ω—Ç–∞–º–∏
- üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Å–∏—Ö–æ-—ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- ‚ö†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–∏—Å–∫–æ–≤
- üì¢ –°–∏—Å—Ç–µ–º–∞ —ç—Å–∫–∞–ª–∞—Ü–∏–∏ –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π
- üë• –ü—Ä–æ–∑—Ä–∞—á–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –∫—É—Ä–∞—Ç–æ—Ä–∞–º–∏

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- Python 3.8+
- FastAPI (–≤–µ–±-—Ñ—Ä–µ–π–º–≤–æ—Ä–∫)
- SQLAlchemy + SQLite (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- python-telegram-bot (Telegram API)
- SHAI.pro API (–∞–Ω–∞–ª–∏–∑ —ç–º–æ—Ü–∏–π)
- Pydantic (–≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö)
- Alembic (–º–∏–≥—Ä–∞—Ü–∏–∏ –ë–î)
- Loguru (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Docker –∏ Docker Compose
- Telegram Bot Token (–æ—Ç @BotFather)
- SHAI.pro API –¥–æ—Å—Ç—É–ø

### –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å Docker

1. –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```bash
git clone https://github.com/Taglat/TomorrowOrNeverShaiPro.git
cd TomorrowOrNeverShaiPro
```

2. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:
```bash
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ .env —Ñ–∞–π–ª —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–æ–∫–µ–Ω–∞–º–∏
```

3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å Docker Compose:
```bash
docker-compose up -d
```

4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É:
```bash
curl http://localhost:8000/
./test_api.sh
```

### –†—É—á–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ (–±–µ–∑ Docker)

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
```bash
pip install -r requirements.txt
```

2. –°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏:
```bash
cp .env.example .env
```

4. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ —Ñ–∞–π–ª–µ `.env`:
```env
# Telegram Configuration
TELEGRAM_BOT_TOKEN=your_telegram_bot_token_here

# SHAI.pro Configuration
SHAI_API_URL=your_shai_api_url_here
SHAI_API_KEY=your_shai_api_key_here

# Database Configuration
DATABASE_URL=sqlite+aiosqlite:///./shai.db

# Escalation Configuration
CURATOR_CHAT_IDS=123456789,987654321  # ID —á–∞—Ç–æ–≤ –∫—É—Ä–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
```

### –ó–∞–ø—É—Å–∫

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–µ—Ä–≤–µ—Ä —Å –ø–æ–º–æ—â—å—é –∫–æ–º–∞–Ω–¥—ã:
```bash
python main.py
```

–°–µ—Ä–≤–µ—Ä –∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –Ω–∞ `http://localhost:8000`

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
SHAI/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api_schemas.py     # API –º–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ database.py       # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models.py         # SQLAlchemy –º–æ–¥–µ–ª–∏
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ schemas.py        # –ë–∞–∑–æ–≤—ã–µ —Å—Ö–µ–º—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îî‚îÄ‚îÄ services/
‚îÇ       ‚îú‚îÄ‚îÄ database_service.py    # –°–µ—Ä–≤–∏—Å —Ä–∞–±–æ—Ç—ã —Å –ë–î
‚îÇ       ‚îú‚îÄ‚îÄ escalation_service.py  # –°–µ—Ä–≤–∏—Å —ç—Å–∫–∞–ª–∞—Ü–∏–∏
‚îÇ       ‚îú‚îÄ‚îÄ shai_service.py        # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å SHAI.pro
‚îÇ       ‚îî‚îÄ‚îÄ telegram_bot.py        # Telegram –±–æ—Ç
‚îú‚îÄ‚îÄ main.py                   # FastAPI –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îú‚îÄ‚îÄ requirements.txt          # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example             # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ .gitignore              # Git –∏–≥–Ω–æ—Ä–∏—Ä—É–µ–º—ã–µ —Ñ–∞–π–ª—ã
‚îú‚îÄ‚îÄ LICENSE                 # MIT –ª–∏—Ü–µ–Ω–∑–∏—è
‚îî‚îÄ‚îÄ README.md               # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## API Endpoints

### GET /api/analyze/{message_id}
–ü–æ–ª—É—á–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è:
```json
{
    "emotion": ["joy", "gratitude"],
    "risk_level": "NO_RISK",
    "escalation_required": false,
    "response_to_user": "..."
}
```

### POST /api/messages
–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –Ω–∞ –∞–Ω–∞–ª–∏–∑:
```json
{
    "message": "–¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è"
}
```

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

### Telegram Bot

- `/start` - –ù–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã —Å –±–æ—Ç–æ–º
- –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –æ—Ç–≤–µ—Ç—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –∫—É—Ä–∞—Ç–æ—Ä–æ–≤ –≤ —Å–ª—É—á–∞–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π

### –°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–∫–∏ —Ä–∏—Å–∫–æ–≤

–ë–æ—Ç –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –∫–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ SHAI.pro API –∏ –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç:
- –≠–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–Ω–∞ –æ—Å–Ω–æ–≤–µ GoEmotions)
- –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞ (NO_RISK, LOW_RISK, MODERATE_RISK, HIGH_RISK)
- –ù–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å —ç—Å–∫–∞–ª–∞—Ü–∏–∏
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

### –°–∏—Å—Ç–µ–º–∞ —ç—Å–∫–∞–ª–∞—Ü–∏–∏

–ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π (MODERATE_RISK –∏–ª–∏ HIGH_RISK + escalation_required):
1. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫—É—Ä–∞—Ç–æ—Ä–æ–≤ —á–µ—Ä–µ–∑ Telegram
2. –ü—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:
   - –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞
   - ID —Å–æ–æ–±—â–µ–Ω–∏—è
   - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –£—Ä–æ–≤–µ–Ω—å —Ä–∏—Å–∫–∞
   - –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ —ç–º–æ—Ü–∏–∏
   - –¢–µ–∫—Å—Ç —Å–æ–æ–±—â–µ–Ω–∏—è
3. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
4. –ü—Ä–æ–∑—Ä–∞—á–Ω–æ–µ –∏–Ω—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –æ –ø—Ä–æ—Ü–µ—Å—Å–µ

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

- –•—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Ö –∞–Ω–∞–ª–∏–∑–∞
- –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –∞–Ω–∞–ª–∏–∑–∞
- –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–µ—Ä–µ–∑ SQLAlchemy
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π —á–µ—Ä–µ–∑ Alembic
